<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Parc véhicules — SAMU 74</title>
  <meta name="theme-color" content="#0b1220" />

  <!-- CSS commun -->
  <link rel="stylesheet" href="shared.css" />

  <style>
    /* Header bouton identique */
    .headerBtn{
      text-decoration:none;
      color:var(--text);
      border:1px solid var(--stroke);
      border-radius:999px;
      padding:10px 14px;
      background: linear-gradient(180deg, #0b142d, #081027);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
      font-size:12px;
      font-weight:900;
      letter-spacing:.2px;
      white-space:nowrap;
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      user-select:none;
    }
    .headerBtn:active{ transform: scale(.99); }
    .headerBtn:hover{
      border-color:#4a6bff;
      box-shadow: 0 0 0 4px rgba(74,107,255,.10), inset 0 1px 0 rgba(255,255,255,.04);
    }

    .layout{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }

    .teamsGrid{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    @media (max-width:900px){
      .teamsGrid{ grid-template-columns: 1fr; }
    }

    .teamCard{
      border:1px solid var(--stroke);
      border-radius: 16px;
      padding: 12px;
      background: linear-gradient(180deg, #0b142d, #081027);
      position:relative;
      overflow:hidden;
    }
    .teamCard::before{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(350px 140px at 10% 0%, rgba(255,255,255,.05), transparent 60%);
      pointer-events:none;
    }

    .teamTitle{
      font-weight:900;
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }

    .slots{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:420px){
      .slots{ grid-template-columns: 1fr; }
    }

    .slot{
      border:1px dashed color-mix(in oklab, var(--stroke) 70%, transparent);
      border-radius: 14px;
      padding:10px;
      min-height: 94px;
      display:flex;
      flex-direction:column;
      gap:8px;
      background: linear-gradient(180deg, rgba(10,18,40,.65), rgba(8,16,39,.65));
    }

    .slotHdr{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .slotLabel{
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      letter-spacing:.2px;
    }
    .slotHint{
      font-size:11px;
      color:color-mix(in oklab, var(--muted) 85%, white 15%);
    }

    .vehList{
      display:grid;
      gap:10px;
    }

    .veh{
      border:1px solid var(--stroke);
      border-radius: 14px;
      padding:10px 10px;
      background: linear-gradient(180deg, #0b142d, #081027);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:10px;
      cursor:grab;
      user-select:none;
      touch-action: none;
    }
    .veh:active{ cursor:grabbing; transform: scale(.995); }

    .vehMain{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width: 0;
    }
    .vehName{
      font-weight:900;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .vehMeta{
      font-size:12px;
      color:var(--muted);
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius:999px;
      font-weight:900;
      border:1px solid var(--stroke);
      background:#0a1228;
      white-space:nowrap;
      font-size:12px;
    }
    .dot{ width:10px; height:10px; border-radius:50%; background: var(--pBlue); }

    .bDispo{ color: var(--ok); border-color: color-mix(in oklab, var(--ok) 45%, var(--stroke) 55%); }
    .bDispo .dot{ background: var(--ok); }

    .bIndispo{ color: var(--bad); border-color: color-mix(in oklab, var(--bad) 45%, var(--stroke) 55%); }
    .bIndispo .dot{ background: var(--bad); }

    .bReserve{ color: var(--pBlue); border-color: color-mix(in oklab, var(--pBlue) 45%, var(--stroke) 55%); }
    .bReserve .dot{ background: var(--pBlue); }

    .vehActions{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
    }
    .miniBtn{
      border:1px solid var(--stroke);
      background: transparent;
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font-weight:900;
      font-size:12px;
      cursor:pointer;
      white-space:nowrap;
    }
    .miniBtn:hover{
      border-color:#4a6bff;
      box-shadow: 0 0 0 4px rgba(74,107,255,.10);
    }

    .dropHover{
      outline: 2px solid rgba(74,107,255,.55);
      box-shadow: 0 0 0 6px rgba(74,107,255,.10);
    }

    /* Modal */
    .modalWrap{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index:9999;
    }
    .modalWrap.open{ display:flex; }
    .modal{
      width:min(820px, 100%);
      border:1px solid var(--stroke);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(15,26,51,.98), rgba(11,20,48,.98));
      box-shadow: 0 20px 50px rgba(0,0,0,.45);
      padding: 14px;
    }
    .modalTop{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
      margin-bottom: 10px;
    }
    .modalTitle{
      font-weight:900;
      letter-spacing:.2px;
      margin:0;
      font-size:16px;
    }
    .closeBtn{
      border:1px solid var(--stroke);
      background: transparent;
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
    }

    .formGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width:700px){
      .formGrid{ grid-template-columns: 1fr; }
    }
    .full{ grid-column: 1 / -1; }

    .small{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
      line-height:1.35;
    }

    /* Petit récap en haut */
    .summaryRow{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    @media (max-width:900px){
      .summaryRow{ grid-template-columns: 1fr; }
    }
    .sumBox{
      border:1px solid var(--stroke);
      border-radius: 16px;
      padding: 12px;
      background: linear-gradient(180deg, #0b142d, #081027);
    }
    .sumBox .t{ color:var(--muted); font-size:12px; }
    .sumBox .v{ font-weight:900; font-size:18px; margin-top:6px; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>Parc véhicules</h1>
        <div class="subtitle">Affectations VLM / UMH • Dispo / Indispo • Réserve</div>
      </div>
      <a class="headerBtn" href="index.html">Accueil</a>
    </div>

    <div class="card">
      <div class="summaryRow">
        <div class="sumBox">
          <div class="t">Dispo</div>
          <div class="v" id="countDispo">—</div>
        </div>
        <div class="sumBox">
          <div class="t">Indispo</div>
          <div class="v" id="countIndispo">—</div>
        </div>
        <div class="sumBox">
          <div class="t">En réserve</div>
          <div class="v" id="countReserve">—</div>
        </div>
      </div>
      <div class="small">Astuce : tu peux <b>glisser-déposer</b> les véhicules <b>Dispo</b> vers un slot VLM/UMH.</div>
    </div>

    <div class="card">
      <div class="hint">Équipes</div>
      <div class="teamsGrid" id="teams"></div>
    </div>

    <div class="card">
      <div class="hint">Réserve (non affectés)</div>
      <div class="vehList" id="reserveList">—</div>
    </div>

    <footer>Dernière mise à jour : Décembre 2025.</footer>
  </div>

  <!-- Modal panne -->
  <div class="modalWrap" id="modalWrap" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalTop">
        <div>
          <h2 class="modalTitle" id="modalTitle">Fiche panne</h2>
          <div class="subtitle" id="modalSub">—</div>
        </div>
        <button class="closeBtn" id="closeModal">Fermer</button>
      </div>

      <div class="formGrid">
        <div>
          <label>Date / heure</label>
          <input id="pDate" type="datetime-local" />
        </div>
        <div>
          <label>Immobilisation ?</label>
          <input id="pImmobil" type="text" placeholder="Ex: oui / non / à confirmer" />
        </div>

        <div class="full">
          <label>Description panne</label>
          <textarea id="pDesc" placeholder="Décris le problème (symptômes, contexte, voyants, etc.)"></textarea>
        </div>

        <div>
          <label>Action réalisée</label>
          <input id="pAction" type="text" placeholder="Ex: reset, appel garage, mise en charge..." />
        </div>
        <div>
          <label>Suivi / Contact</label>
          <input id="pContact" type="text" placeholder="Ex: atelier, astreinte, tel..." />
        </div>

        <div class="full btns">
          <button id="savePanneBtn">Enregistrer</button>
          <button id="cancelPanneBtn" class="secondary">Annuler (reste Dispo)</button>
        </div>
      </div>
    </div>
  </div>

  <script src="vehicules.js"></script>
</body>
</html>